{% extends 'base.html' %}

{% block title %}Shopping Cart - Boonyisa Shop{% endblock %}

{% block content %}
  <div class="container mb-5">
    <h1 class="display-5 mb-4">Shopping Cart</h1>

    {% if cart_items %}
      <div class="row">
        <div class="col-lg-8">
          {% for item in cart_items %}
          <div class="card mb-3">
            <div class="card-body">
              <div class="row">
                <div class="col-md-2"><img src="{{ item.product.image_url }}" class="cart-item-img" alt="{{ item.product.name }}"></div>
                <div class="col-md-5"><h5 class="card-title">{{ item.product.name }}</h5><p class="text-muted">Price: ฿{{ '%.2f'|format(item.product.price) }}</p></div>
                <div class="col-md-2">
                  <div class="d-flex align-items-center gap-2">
                    <form method="post" action="{{ url_for('update_cart', product_id=item.product.id, action='decrease') }}" style="display:inline"><button type="submit" class="qty-btn">−</button></form>
                    <span><strong>{{ item.qty }}</strong></span>
                    <form method="post" action="{{ url_for('update_cart', product_id=item.product.id, action='increase') }}" style="display:inline"><button type="submit" class="qty-btn">+</button></form>
                  </div>
                </div>
                <div class="col-md-2 text-end"><p><strong class="text-success">฿{{ '%.2f'|format(item.product.price * item.qty) }}</strong></p></div>
                <div class="col-md-1"><form method="post" action="{{ url_for('remove_from_cart', product_id=item.product.id) }}" style="display:inline"><button class="btn btn-sm btn-danger">×</button></form></div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>

        <div class="col-lg-4">
          <div class="card p-4 text-center">
            <h4 class="card-title">Order Summary</h4>
            <hr class="my-2">
            <p class="mb-3">Total Items: <strong>{{ cart_items|length }}</strong></p>
            <p class="mb-4"><span class="h5">Total: </span> <span class="h4 text-success">฿{{ '%.2f'|format(total) }}</span></p>
            <button class="btn btn-primary btn-lg w-100 mb-2">Checkout</button>
            <a href="{{ url_for('index') }}" class="btn btn-outline-primary w-100">Continue Shopping</a>
          </div>
        </div>
      </div>
    {% else %}
      <div class="card text-center p-5">
        <p class="text-muted mb-3">Your cart is empty</p>
        <a href="{{ url_for('index') }}" class="btn btn-primary">Continue Shopping</a>
      </div>
    {% endif %}
  </div>
{% endblock %}
